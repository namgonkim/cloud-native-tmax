# 클라우드 개발자 양성과정

## 상용 클라우드를 이용한 어플리케이션 배포
[소스코드](https://github.com/namgonkim/msa-ecommerce-tmax)
* 토이 프로젝트를 통한 msa 어플리케이션 실습
    - Config Server
    - Spring Boot Actuator

## Config Server
* 각 서비스들의 환경 설정 정보가 변경되었을 때, 이들을 각각 다시 빌드하지 않도록 하나의 환경 설정 정보만 저장하고 있는 서버
    - Config Service 프로젝트 생성

### Config Service
#### private git repository
* local에 저장되어 있는 yaml 파일을 load

    1. ~/Work/git-local-repo 디렉토리 생성 
    2. $ cd git-local-repo
    3. $ git init
    4. ecommerce.yml 파일 생성
    5. $ git add ecommerce.yml.
    6. $ git commit –m “upload an application yaml file”
    7. service의 application.yml에 git-local-repo uri file로 연결
        - file:// ~

* 우선 순위
    1. ecommerce-[profile].yml
    2. ecommerce.yml
    3. application.yml

#### User-service -> bootstrap.yml
* spring-cloud-starter-bootstrap 디펜던시를 추가하여 사용
* 어플리케이션 실행 시, application.yml보다 먼저 읽는다.
* bootstrap에 환경 설정 서버를 추가해준다.

## Spring Boot Actuator
* 어플리케이션 상태, 모니터링 체크
* Metric 수집을 위한 http 엔드포인트를 제공

### /actuator/refresh
* 변경된 환경 설정을 서버 재가동이 아닌 /actuator/refresh를 통해 업데이트

#### User-service -> actuator 정보 추가
* api gateway를 타고 user service의 actuator가 정상적으로 작동될 수 있도록 설정